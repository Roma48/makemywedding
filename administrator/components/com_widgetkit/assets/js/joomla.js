!function(t,n){angular.module("widgetkit").run(["$rootScope","$rootElement","$timeout",function(i,e,o){function a(){d.find("#toolbar-apply button, #toolbar-save button").prop("disabled",e.find("form.ng-invalid").length)}n.parent.document.updateUploader=n.parent.document.updateUploader||function(){};var s=t("body.com_widgetkit"),c=s.find(".header .container-title").append('<h1 class="page-title"><span class="icon-widgetkit"></span>Widgetkit: <span></span></h1>').find(".page-title span").eq(1),d=s.find(".subhead .btn-toolbar"),l='<div class="btn-wrapper uk-button-dropdown" id="toolbar-create" data-uk-dropdown="{ mode: \'click\' }"><button class="btn btn-small btn-success"></span>New Content <i class="uk-icon-caret-down"></i></button></div>',p='<div class="btn-wrapper" id="toolbar-apply"><button class="btn btn-small btn-success"><span class="icon-apply icon-white"></span> Save</button></div>                           <div class="btn-wrapper" id="toolbar-save"><button class="btn btn-small"><span class="icon-save"></span> Save & Close</button></div>                           <div class="btn-wrapper" id="toolbar-cancel"><button class="btn btn-small"><span class="icon-cancel"></span> Close</button></div>',r='<div class="btn-wrapper" id="toolbar-options"><button class="btn btn-small"><span class="icon-options"></span> Options</button></div>';d.on("click","#toolbar-create a",function(){e.find(".js-header .uk-dropdown li").eq(t(this).parent().index()).find("a").trigger("click")}).on("click","#toolbar-apply",function(){var t=e.scope();t.vm.saveContent()}).on("click","#toolbar-save",function(){var t=e.scope();t.vm.saveContent().$promise.then(function(){t.vm.closeContent()})}).on("click","#toolbar-cancel",function(){var t=e.scope();t.vm.closeContent(),t.$apply()}).on("click","#toolbar-options",function(){location.href="index.php?option=com_config&view=component&component=com_widgetkit"}),s.on("keyup",'[ng-model="content.name"]',a),i.$on("wk.change.view",function(n,i){o(function(){c.text(e.find("h2.js-header").text()),d.html("content"==i?t(l).append(e.find(".js-header .uk-dropdown").clone()):p).append(r),a()})})}]),t(function(){t(".btn-toolbar").on("click",'[rel="widgetkit"]',function(i){i.preventDefault(),i.stopPropagation();for(var e=t(this);e.length&&!e.has("textarea").length;)e=e.parent();n.widgetkit.env.editor(e.find("textarea:first"))}),t("body.view-module").on("click","button.widgetkit-widget",function(i){i.preventDefault();var e,o=t(this),a=t(this).nextAll("input");try{e=JSON.parse(a.val())}catch(i){e={}}n.widgetkit.env.init(e,function(i){a.val(JSON.stringify(i)),i.widget&&n.widgetkit.config.widgets[i.widget]&&(t("span",o).html("&nbsp;&nbsp;"+n.widgetkit.config.widgets[i.widget].label),o.find("img").remove().end().prepend(t('<img height="16" width="16" />').attr("src",n.widgetkit.config.widgets[i.widget].icon)))})}),t("body.view-module .widgetkit-widget").each(function(){var i,e=t(this),o=t(this).nextAll("input");try{i=JSON.parse(o.val())}catch(a){i={}}i.widget&&n.widgetkit.config.widgets[i.widget]&&(t("span",e).html("&nbsp;&nbsp;"+n.widgetkit.config.widgets[i.widget].label),e.find("img").remove().end().prepend(t('<img height="16" width="16" />').attr("src",n.widgetkit.config.widgets[i.widget].icon)))})})}(jQuery,window);